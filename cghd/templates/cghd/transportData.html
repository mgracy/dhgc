{% extends 'cghd/base.html' %}
{% load staticfiles %}
{% block main %}
<form id="form1" method="post">
	{% csrf_token %}

	<div class="row"><h3>调度物流：维护运输数据</h3></div>	

	<div class="form">
		<div class="form-group">
			<input type="button" id="btnCancel" class="btn btn-warning" value="放弃">
			<input type="button" id="btnSubmit" class="btn btn-warning" value="提交">
			<input type="hidden" id="hiddenData" name="hiddenData">
		</div>
		<div class="form-inline">
		    <div class="row col-md-12" style="margin-bottom:5px">
		      <div class="form-group input-group-sm col-xs-3 col-md-3 col-lg-3">
		        <label for="txtSalesNo">销售单号</label>
		        <input type="text" class="form-control" id="txtSalesNo"  name="txtSalesNo" >
		      </div>
		      <div class="form-group input-group-sm col-xs-3 col-md-3 col-lg-3">
		        <label for="txtArea">区&nbsp;&nbsp;&nbsp;域</label>
		        <input type="text" class="form-control" id="txtArea" name="txtArea">
		      </div>
		      <div class="form-group input-group-sm col-xs-4 col-md-4 col-lg-4">
		        <label for="txtSourceAddress">气源地址</label>
		        <input type="text" class="form-control" id="txtSourceAddress" name="txtSourceAddress">
		      </div>
		    </div>
		    <div class="row col-md-12" style="margin-bottom:5px">
		      <div class="form-group input-group-sm col-xs-3 col-md-3 col-lg-3">
		        <label for="txtUnloadDate">卸货日期</label>
		        <input type="date" class="form-control" id="txtUnloadDate" name="txtUnloadDate">
		      </div>
		      <div class="form-group input-group-sm col-xs-3 col-md-3 col-lg-3">
		        <label for="txtSales">销售员</label>
		        <input type="text" class="form-control" id="txtSales" name="txtSales">
		      </div>
		      <div class="form-group input-group-sm col-xs-4 col-md-4 col-lg-4">
		        <label for="txtClientType">客户类型</label>
		        <input type="text" class="form-control" id="txtClientType" name="txtClientType">
		      </div>
		    </div>
		    <div class="row col-md-12" style="margin-bottom:0px">
		      <div class="form-group input-group-sm col-xs-3 col-md-3 col-lg-3">
		        <label for="txtSalesDate">下单日期</label>
		        <input type="date" class="form-control" id="txtSalesDate" name="txtSalesDate">
		      </div>
		      <div class="form-group input-group-sm col-xs-3 col-md-3 col-lg-3">
		        <label for="txtSupplier">供应商</label>
		        <input type="text" class="form-control" id="txtSupplier" name="txtSupplier">
		      </div>
		      <div class="form-group input-group-sm col-xs-4 col-md-4 col-lg-4">
		        <input type="button" class="btn btn-primary col-xs-offset-2 col-md-offset-2 col-lg-offset-2 col-xs-6 col-md-6 col-lg-6" id="btnQuery" value="查询">
		      </div>
		    </div>
		</div>
		<div>&nbsp;</div>
	</div>
	
	<div id="kv-error-1" class="alert alert-warning" style="margin-top:10px;display:none;" role="alert"></div>
	<div id="kv-success-1" class="alert alert-success" style="margin-top:10px;display:none;" role="alert"></div>
	<div id="divResult"></div>
</form>

<script>
	$(document).ready(function(){	    	
		$("#btnQuery").click(function(){
			var salesNo = $('#txtSalesNo').val();
			var area = $('#txtArea').val();
			var sourceAddress = $('#txtSourceAddress').val();
			var unloadDate = $('#txtUnloadDate').val();
			var salesMen = $('#txtSales').val();
			var clientType = $('#txtClientType').val();
			var salesDate = $('#txtSalesDate').val();
			var supplier = $('#txtSupplier').val();

			$.ajax({
				url:'/cghd/getorderinfo',
				type: 'get',
				data: {'salesNo': salesNo, 'area': area, 'sourceAddress': sourceAddress, 'unloadDate': unloadDate, 'salesMen': salesMen, 'clientType': clientType, 'salesDate': salesDate, 'supplier': supplier},
				datatype: 'json',
				success:function(data){
				var data = eval('(' + data + ')');
				var table = '<table class="table table-striped"> '+
						'<tr> '+
							'<th>销售单号</th>'+
							'<th>区域</th>'+
							'<th>客户性质</th>'+
							'<th>客户类型</th>'+
							'<th>客户名称</th>'+
							'<th>卸货日期</th>'+
							'<th>卸货时间</th>'+
							'<th>卸气地址</th>'+							
							// '<th>供应商ID</th>'+
							'<th>供应商</th>'+
							'<th>气源地</th>'+
							'<th>票制</th>'+
							// '<th>承运商ID</th>'+
							'<th class="dbclicktd">承运公司</th>'+			
							'<th class="dbclicktd">装货日期</th>'+
							'<th class="dbclicktd">牵引车号</th>'+
							'<th class="dbclicktd">槽车号</th>'+
							'<th class="dbclicktd">驾驶员</th>'+
							'<th class="dbclicktd">押运员</th>'+
							'<th class="dbclicktd">手机号</th>'+
							'<th class="dbclicktd">磅差</th>'+
							'<th class="dbclicktd">装气量</th>'+
							'<th class="dbclicktd">卸气量</th>'+
							'<th>销售员</th>'+
							'<th>下单日期</th>'+
							'<th>订单状态</th>'+							
							'<th>备注</th>'+
							'<th style="display:none;">id</th>'+
						'</tr> ';
			    for(var i=0; i<data.length; i++) {
					table += '<tr> '+
							'<td>' + data[i]["Order_No"] + '</td>'+
							'<td>' + data[i]["Area"] + '</td>'+
							'<td>' + data[i]["In_Out"] + '</td>'+
							// '<td>' + data[i]["C_ID"] + '</td>'+
							'<td>' + data[i]["C_Type"] + '</td>'+
							'<td>' + data[i]["C_BriefName"] + '</td>'+
							'<td>' + data[i]["Unload_Date"] + '</td>'+
							'<td>' + data[i]["Unload_Time"] + '</td>'+
							'<td>' + data[i]["Unload_Address"] + '</td>'+
							'<td>' + data[i]["S_BriefName"] + '</td>'+
							'<td>' + data[i]["Source_Address"] + '</td>'+
							'<td>' + data[i]["Trade_Type"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Carrier_BriefName"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Load_Date"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Tractor_No"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Tank_No"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Driver"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Supercargo"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Tele_No"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Gap_Pounds"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Load_QTY"] + '</td>'+
							'<td class="dbclicktd">' + data[i]["Unload_QTY"] + '</td>'+
							'<td>' + data[i]["Salesmen"] + '</td>'+
							'<td>' + data[i]["Create_Date"] + '</td>'+
							'<td>' + data[i]["State"] + '</td>'+
							'<td>' + data[i]["Dispatch_Mark"] + '</td>'+
							'<td style="display:none;">' + data[i]["id"] + '</td>'+
						'</tr>';
				}

				table += '</table';
							
				$("#divResult").html(table);	
				$('#kv-success-1').html("查询成功, 共有 " + data.length + " 条记录");
				$('#kv-success-1').fadeIn('show').fadeOut(3000);
				},
				error:function(err){
					console.log(err);
				}
			})	   	
		});
	});
</script>

{% endblock %}